<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Sources Health – Free Intel Hub</title>
  <link rel="stylesheet" href="/style.css"/>
</head>
<body>
  <%- include("partials/navbar") %>

  <div class="container">
    <div class="section-title">Source Health & Feed Uptime</div>

    <div class="grid">
      <% sources.forEach(s => { 
           const total = s.success_count + s.fail_count;
           const uptime = total ? Math.round((s.success_count / total) * 100) : 0;
      %>
        <article class="card">
          <h4><%= s.source %></h4>
          <p>
            Status: <b><%= s.last_status %></b><br/>
            Last checked: <%= s.last_checked_at ? new Date(s.last_checked_at).toLocaleString() : "—" %><br/>
            Items: <%= s.total_items %><br/>
            Uptime: <%= uptime %>%
          </p>
          <div class="badges">
            <a class="badge" href="/source/<%= encodeURIComponent(s.source) %>">View articles</a>
            <a class="badge" href="<%= s.url %>" target="_blank">RSS</a>
          </div>
        </article>
      <% }) %>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
<%- include("partials/footer") %>
